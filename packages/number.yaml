
number:
  - platform: template
    name: "Luci Slot 1 Inizio Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_hour)[0] = (int)(x);
    
  - platform: template
    name: "Luci Slot 1 Inizio Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_minute)[0] = (int)(x);
    
  - platform: template
    name: "Luci Slot 2 Inizio Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_hour)[1] = (int)(x);
    
  - platform: template
    name: "Luci Slot 2 Inizio Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_minute)[1] = (int)(x);

  - platform: template
    name: "Luci Slot 3 Inizio Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_hour)[2] = (int)(x);
    
  - platform: template
    name: "Luci Slot 3 Inizio Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_minute)[2] = (int)(x);

  - platform: template
    name: "Luci Slot 3 Termine Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_hour)[3] = (int)(x);
    
  - platform: template
    name: "Luci Slot 3 Termine Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_minute)[3] = (int)(x);

  - platform: template
    name: "Luci Slot 0 Min"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_min)[0] = (int)(x);

  - platform: template
    name: "Luci Slot 1 Min"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_min)[1] = (int)(x);

  - platform: template
    name: "Luci Slot 2 Min"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_min)[2] = (int)(x);

  - platform: template
    name: "Luci Slot 3 Min"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_min)[3] = (int)(x);

  - platform: template
    name: "Luci Slot 0 Max"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_max)[0] = (int)(x);

  - platform: template
    name: "Luci Slot 1 Max"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_max)[1] = (int)(x);

  - platform: template
    name: "Luci Slot 2 Max"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_max)[2] = (int)(x);

  - platform: template
    name: "Luci Slot 3 Max"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 100
    step: 1
    on_value:
        then:
            lambda: |-
                id(lights_timer_slot_value_max)[3] = (int)(x);

  - platform: template
    name: "Feeder Slot 1 Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(fishfeeder_timer_slot_hour)[0] = (int)(x);
    
  - platform: template
    name: "Feeder Slot 1 Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(fishfeeder_timer_slot_minute)[0] = (int)(x);
    
  - platform: template
    name: "Feeder Slot 2 Ore"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 23
    step: 1
    on_value:
        then:
            lambda: |-
                id(fishfeeder_timer_slot_hour)[1] = (int)(x);
    
  - platform: template
    name: "Feeder Slot 2 Minuti"
    optimistic: true
    restore_value: true
    min_value: 0
    max_value: 59
    step: 1
    on_value:
        then:
            lambda: |-
                id(fishfeeder_timer_slot_minute)[1] = (int)(x);

  - platform: template
    name: "Feeder Posizione"
    id: feeder_slider
    optimistic: true
    restore_value: true
    min_value: 1
    max_value: 32
    step: 1
    on_value:
        then:
            - if:
                condition:
                    lambda: 'return (abs(id(fishfeeder_last_position) - x) > 1);'
                then:
                    - lambda: 'ESP_LOGD("feeder_slider", "Multiple step movement: last position %d, new position %", id(fishfeeder_last_position), x);'
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1));'
                    - lambda: 'id (fishfeeder_last_position) = (int)x;'
                else:
                    - lambda: 'ESP_LOGD("feeder_slider", "Single step movement: last position %d, new position %", id(fishfeeder_last_position), x);'
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1));'
                    - delay: 1s
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1))+46;'     
                    - delay: 1s
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1));'
                    - lambda: 'id (fishfeeder_last_position) = (int)x;'
                    - delay: 1s
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1))+46;'     
                    - delay: 1s
                    - stepper.set_target:
                        id: fish_feeder_stepper
                        target: !lambda 'return -(68*(int)(x-1));'
                    - lambda: 'id (fishfeeder_last_position) = (int)x;'

  - platform: template
    name: "Sensore luce minimo"
    id: sensor_light_min
    restore_value: true
    min_value: 0
    max_value: 200
    step: 1
    optimistic: true
    initial_value: '0'
    
  - platform: template
    name: "Sensore luce massimo"
    id: sensor_light_max
    restore_value: true
    min_value: 0
    max_value: 200
    step: 1
    optimistic: true
    initial_value: '0'